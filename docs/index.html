<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<title>Potato Clip Editor</title>
		<link rel="icon" type="image/svg+xml" href="./favicon.svg" />
		<script src="deps/vue.js"></script>
		<!-- Tailwind generated classes -->
		<link rel="stylesheet" type="text/css" href="./styles.css" />
		<style>
			/* Add custom styles here */
		</style>
	</head>
	<body>
		<div id="app" class="grid grid-rows-[auto,1fr,128px] gap-8 max-w-screen-xl mx-auto px-4 sm:px-6 lg:px-8 h-screen py-8">
			<!-- We've used 3xl here, but feel free to try other max-widths based n your needs -->
			<header class="bg-gradient-to-br from-indigo-800 to-indigo-500 pb-2 bg-clip-text">
				<h1 class="text-5xl italic font-bold text-transparent">Potato Clip Editor</h1>
			</header>
			<main class="flex flex-col-reverse gap-8 lg:flex-row" v-if="clips.length > 0">
				<section id="timeline" class="min-w-[400px] flex flex-col">
					<span class="uppercase font-medium text-gray-600 text-sm pb-4">Timeline</span>
					<ul class="flex flex-col space-y-2">
						<li
							v-for="clip in clips"
							:key="clip.key"
							tabindex="0"
							@click="selectPreview(clip.key)"
							class="flex flex-col p-2 cursor-pointer bg-white rounded-lg border border-gray-300 hover:border-gray-400 focus:outline-none focus:ring-1 ring-indigo-600"
							:class="{ 'border-indigo-600 hover:border-indigo-600': previewKey === clip.key }"
						>
							<div class="flex">
								<span class="font-semibold text-gray-800">{{ clip.name }}</span>
								<div class="flex ml-auto space-x-1 items-start">
									<button
										@click="duplicateClip(clip.key)"
										class="p-1 rounded text-gray-400 hover:text-indigo-600 focus:text-indigo-600 focus:outline-none focus:ring-1 ring-indigo-600"
									>
										<svg width="24" height="24" fill="none" viewBox="0 0 24 24">
											<path
												stroke="currentColor"
												stroke-linecap="round"
												stroke-linejoin="round"
												stroke-width="1.5"
												d="M6.5 15.25V15.25C5.5335 15.25 4.75 14.4665 4.75 13.5V6.75C4.75 5.64543 5.64543 4.75 6.75 4.75H13.5C14.4665 4.75 15.25 5.5335 15.25 6.5V6.5"
											></path>
											<rect
												width="10.5"
												height="10.5"
												x="8.75"
												y="8.75"
												stroke="currentColor"
												stroke-linecap="round"
												stroke-linejoin="round"
												stroke-width="1.5"
												rx="2"
											></rect>
										</svg>
									</button>
									<button
										@click="removeClip(clip.key)"
										class="p-1 rounded text-gray-400 hover:text-red-600 focus:text-red-600 focus:outline-none focus:ring-1 ring-red-600"
									>
										<svg width="24" height="24" fill="none" viewBox="0 0 24 24">
											<path
												stroke="currentColor"
												stroke-linecap="round"
												stroke-linejoin="round"
												stroke-width="1.5"
												d="M6.75 7.75L7.59115 17.4233C7.68102 18.4568 8.54622 19.25 9.58363 19.25H14.4164C15.4538 19.25 16.319 18.4568 16.4088 17.4233L17.25 7.75"
											></path>
											<path
												stroke="currentColor"
												stroke-linecap="round"
												stroke-linejoin="round"
												stroke-width="1.5"
												d="M9.75 7.5V6.75C9.75 5.64543 10.6454 4.75 11.75 4.75H12.25C13.3546 4.75 14.25 5.64543 14.25 6.75V7.5"
											></path>
											<path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M5 7.75H19"></path>
										</svg>
									</button>
								</div>
							</div>
							<div class="text-gray-600">
								<span>{{ renderTime(clip.startTime) }}</span>
								-
								<span>{{ renderTime(clip.endTime) }}</span>
							</div>
						</li>
					</ul>
				</section>
				<section id="preview" class="flex flex-col w-full h-full">
					<span class="uppercase font-medium text-gray-600 text-sm pb-4">Preview</span>
					<div v-for="clip in clips" :key="clip.key" class="space-y-4" :class="[previewKey === clip.key ? 'block' : 'hidden']">
						<div class="aspect-w-16 aspect-h-9">
							<video :src="clip.url" controls muted :ref="setVideoRef(clip)" v-on:loadedmetadata="setMetadata(clip)"></video>
						</div>
						<div class="flex items-center justify-between">
							<input
								type="text"
								:value="renderTime(clip.startTime)"
								class="w-[10ch] text-gray-700 border-gray-300 rounded-md focus:ring-indigo-600 focus:ring-offset-indigo-600 focus:border-indigo-600"
								readonly
							/>
							<div class="flex">
								<button
									@click="setStartTime(clip)"
									class="text-gray-400 border border-gray-300 hover:border-indigo-600 focus:border-indigo-600 hover:text-indigo-600 focus:text-indigo-600 p-2 rounded-l-md focus:outline-none focus:ring-1 focus:ring-indigo-600 z-10"
								>
									<svg width="24" height="24" fill="none" viewBox="0 0 24 24">
										<path
											stroke="currentColor"
											stroke-linecap="round"
											stroke-linejoin="round"
											stroke-width="1.5"
											d="M10.25 6.75L4.75 12L10.25 17.25"
										></path>
										<path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M19.25 12H5"></path>
									</svg>
								</button>
								<input
									type="text"
									:value="renderTime(clip.endTime - clip.startTime)"
									class="w-[10ch] text-gray-700 border-gray-300 border-l-0 border-r-0 focus:ring-indigo-600 focus:ring-offset-indigo-600 focus:border-indigo-600"
									readonly
								/>
								<button
									@click="setEndTime(clip)"
									class="text-gray-400 border border-gray-300 hover:border-indigo-600 focus:border-indigo-600 hover:text-indigo-600 focus:text-indigo-600 p-2 rounded-r-md focus:outline-none focus:ring-1 focus:ring-indigo-600"
								>
									<svg width="24" height="24" fill="none" viewBox="0 0 24 24">
										<path
											stroke="currentColor"
											stroke-linecap="round"
											stroke-linejoin="round"
											stroke-width="1.5"
											d="M13.75 6.75L19.25 12L13.75 17.25"
										></path>
										<path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M19 12H4.75"></path>
									</svg>
								</button>
							</div>

							<input
								type="text"
								:value="renderTime(clip.endTime)"
								class="w-[10ch] text-gray-700 border-gray-300 rounded-md focus:ring-indigo-600 focus:ring-offset-indigo-600 focus:border-indigo-600"
								readonly
							/>
						</div>
					</div>
				</section>
			</main>
			<footer class="pb-4">
				<label for="file-upload" class="grid place-items-center border-2 border-gray-300 border-dashed rounded-lg h-full cursor-pointer">
					<div class="space-y-1 text-center">
						<svg class="mx-auto h-12 w-12 text-gray-400" stroke="currentColor" fill="none" viewBox="0 0 48 48" aria-hidden="true">
							<path
								d="M28 8H12a4 4 0 00-4 4v20m32-12v8m0 0v8a4 4 0 01-4 4H12a4 4 0 01-4-4v-4m32-4l-3.172-3.172a4 4 0 00-5.656 0L28 28M8 32l9.172-9.172a4 4 0 015.656 0L28 28m0 0l4 4m4-24h8m-4-4v8m-12 4h.02"
								stroke-width="2"
								stroke-linecap="round"
								stroke-linejoin="round"
							/>
						</svg>
						<div class="flex text-sm text-gray-600">
							<span
								class="rounded-md font-medium text-indigo-600 hover:text-indigo-600 focus-within:outline-none focus-within:ring-2 focus-within:ring-offset-2 focus-within:ring-indigo-600"
							>
								Add a video file
								<input
									ref="videoFileInput"
									id="file-upload"
									name="file-upload"
									type="file"
									accept="video/*"
									class="sr-only"
									multiple
									@input="addClip"
								/>
							</span>
							<p class="pl-1">or drag and drop</p>
						</div>
					</div>
				</label>
			</footer>
		</div>
		<script type="module" src="main.js"></script>
	</body>
</html>
